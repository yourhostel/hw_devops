# postgres-deployment.yaml

apiVersion: v1
kind: Pod
metadata:
  name: myapp-pod
  annotations:
    vault.hashicorp.com/agent-inject: "true"
    vault.hashicorp.com/role: "internal-app"
    vault.hashicorp.com/agent-inject-secret-database-config: "internal/database/config"
spec:
  serviceAccountName: internal-app
  containers:
    - name: myapp
      image: myapp-image:latest
      env:
        - name: DB_USERNAME
          valueFrom:
            secretKeyRef:
              name: vault-secrets
              key: username
        - name: DB_PASSWORD
          valueFrom:
            secretKeyRef:
              name: vault-secrets
              key: password
      volumeMounts:
        - name: vault-secrets
          mountPath: /vault/secrets
  volumes:
    - name: vault-secrets
      emptyDir: {}










